# Electric Heating Planning: Climate TRACE Hotspot Analysis

This project analyzes Climate TRACE onsite fuel usage emissions to answer: **Where should energy utilities plan to expand electric heating infrastructures?** It ingests emissions data, identifies within-country hotspots, scores them for prioritization, clusters them into archetypes, and provides an interactive (non-map) Streamlit app for exploration.

## Data and Scope

- Source: Climate TRACE v4.7.1 datasets for residential and non-residential onsite fuel usage (country-level and source-level).
- Emissions metric: CO₂-equivalent (100-year GWP).
- Focus: Onsite fossil heating emissions.
- Out of scope: Electricity generation, transport, heavy industry, or detailed asset siting.

## What the pipeline does 

- Ingestion: CSV → Parquet using DuckDB (memory-efficient, all_varchar for robustness).
- EDA: Missing-value checks and basic sanity summaries on Parquet.
- Aggregation: Country-level and administrative geometry-level emissions.
- Merging: Residential and non-residential hotspots combined.
- Priority scoring: Uses emissions magnitude and residential share to create global and country-normalized rankings.
- Clustering: Unsupervised KMeans to form hotspot archetypes for planning (not prediction).
- Visualization: Streamlit app with interactive filtering, ranking, and cluster exploration (no maps).

## Project Structure

```
electric-heating-planning/
├── data/
│   ├── raw/
│   └── processed/
├── outputs/
│   └── tables/
├── src/
│   ├── ingest.py
│   ├── eda.py
│   ├── analysis.py
│   ├── hotspots.py
│   ├── hotspot_merge.py
│   ├── priority_score.py
│   └── ml_hotspot_clustering.py
├── app/
│   ├── Home.py
│   ├── utils.py
│   └── pages/
│       ├── 1_Global_Overview.py
│       ├── 2_Country_Drilldown.py
│       ├── 3_Cluster_Explorer.py
│       └── 4_Data_Dictionary.py
├── main.py
└── README.md
```

## Dependencies

- Python ≥ 3.10
- pandas
- duckdb
- numpy
- scikit-learn
- streamlit
- plotly

Install in one step:
```bash
pip install pandas duckdb numpy scikit-learn streamlit plotly
```

## How to run

### 1) Run the analysis pipeline
```bash
python main.py
```
What happens:
- Ingests raw CSVs from `data/raw/` to Parquet in `data/processed/`.
- Generates EDA tables for missing values.
- Computes rankings, geometry-level hotspots, merged hotspots, priority scores, and clusters.
- Writes outputs to `outputs/tables/`.

Notes:
- Large CSVs can take several minutes.
- Existing Parquet files are reused; ingestion is skipped if already present.

### 2) Run the Streamlit app
```bash
streamlit run app/Home.py
```
Notes:
- The app reads only from `outputs/tables/` and does no recomputation.
- Provides interactive filtering, ranking, and cluster exploration.
- No maps are included (geometry IDs only).

## Geometry References (geometry_ref)

`geometry_ref` is an identifier, not coordinates:
- `ghs-fua_*` = functional urban area (city-scale).
- `gadm_*` = administrative region (regional-scale).
Mapping to city/region names requires external GIS lookup tables and is out of scope.

## Outputs (in `outputs/tables/`)

- `hotspots_priority_global.csv`: Global-ranked hotspots.
- `hotspots_priority_by_country.csv`: Top-ranked hotspots within each country.
- `hotspots_clustered.csv`: Hotspots with cluster assignments and labels.
- `hotspots_cluster_summary.csv`: Cluster-level summaries.
- Additional EDA and ranking tables (country-level, geometry-level) generated by the pipeline.

## Limitations

- No exact geolocation or infrastructure placement; results are strategic, not engineering designs.
- Based on modeled emissions (Climate TRACE), not meter-level measurements.
- Time coverage follows the Climate TRACE release used (v4.7.1).
- Mapping `geometry_ref` to place names requires external GIS tables (not included).
- No maps are provided due to lack of reliable lat/lon in the source data.

## Intended Use

- Strategic planning and prioritization for electric heating expansion.
- Academic or policy analysis where transparent, explainable heuristics are preferred.
- Not a substitute for detailed engineering studies or grid impact assessments.
